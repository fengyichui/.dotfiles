#!/bin/bash

cmdpath="$(command -v "$1" 2>/dev/null)"
if [[ ! -f "$cmdpath" ]]; then
    echo "No such file: $1"
    exit 1
fi

if [[ -n "$WSL_DISTRO_NAME" ]]; then
    # Startup wsl.exe to create new instance, and use "cmd.exe /c start /b"
    setsid >/tmp/setsid.${1##*/}.log 2>&1 cmd.exe '/c' start '/b' wsl.exe "$@" &
else
    setsid >/tmp/setsid.${1##*/}.log 2>&1 "$@" &
fi
